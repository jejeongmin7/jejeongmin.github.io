---
title: "API에서 제공하는 값을 가공하기 2021-02-09"
date: 2021-02-09 00:01:28 -0400
categories: Development
---

각 API마다 제공하는 값 구조가 다르기 때문에 제가 가공하는 방식을 공유하고 싶어 정리해본 글입니다.
<hr>

# API란?
저는 API가 응용 프로그램에서 사용할 수 있는 데이터를 모아둔 인터페이스라고 생각합니다. 예를 들어 날씨 앱은 기본적인 틀 UI(화면)에 데이터 API(날씨 정보)를 합하여 만들어진 것입니다.
그렇기 때문에 와이파이가 연결되어 있지 않으면 API를 불러오지 못해 날씨를 확인할 수 없는 것입니다.

# 보통 API가 제공하는 방식
이 API는 특정 날짜에 따른 전 세계의 모든 축구 경기 정보를 반환해줍니다. 
![](https://user-images.githubusercontent.com/52072077/107377878-c99b5500-6b2e-11eb-9622-55c40d83397b.png)

# 매핑을 통해 API에서 필요없는 값을 제거하기
API에서 필요없는 값을 제거하기 위해선 필요한 값만 작성한 속성을 만들어 매핑을 시켜줘야합니다.
```go
// API와 언어에 따라 속성 작성 방식은 달라집니다.
type FixturesDto struct {
	Api ApiDto `json:"api"`
}

type ApiDto struct {
	Fixture []FixtureDto `json:"fixtures"`
}

type FixtureDto struct {
	FixtureID     int     `json:"fixture_id"`
	LeagueID      int     `json:"league_id"`
	EventDate     string  `json:"event_date"`
	Status        string  `json:"status"`
	HomeTeam      TeamDto `json:"homeTeam"`
	AwayTeam      TeamDto `json:"awayTeam"`
	GoalsHomeTeam int     `json:"goalsHomeTeam"`
	GoalsAwayTeam int     `json:"goalsAwayTeam"`
}

type TeamDto struct {
	TeamName string `json:"team_name"`
	Logo     string `json:"logo"`
}
```

API 값을 받아와 미리 작성해둔 속성과 매핑해줍니다.

```go
// FixturesDto 타입 변수 선언
var AllFixtures FixturesDto
// API 요청 
req, _ := http.NewRequest("GET", URL, nil)
res, _ := http.DefaultClient.Do(req)
defer res.Body.Close()
// FixturesDto 타입 규격에 맞게 매핑
dec := json.NewDecoder(res.Body)
dec.Decode(&AllFixtures)
return AllFixtures
```

# 필터링을 통해 API에서 특정 값을 가진 데이터만 반환하기
모든 축구 경기의 정보가 아닌 유럽의 축구 경기 정보만 반환하기 위해선 값을 순회해야 합니다.
```go
// FixturesDto 타입 빈 변수 선언
var SelectedFixtures FixturesDto
// 각 경기 데이터를 순회하며 지역이 유럽일 경우 빈 변수에 해당 경기 추가
for _, val := range AllFixtures.Api.Fixture {
		if val.LeagueCountry == "Europe" {
			SelectedFixtures.Api.Fixture = append(SelectedFixtures.Api.Fixture, val)
		}
	}
return SelectedFixtures
```

# 가공 후 API 값 
특정 날짜에 따른 유럽 5대 리그(+챔스, 유로파) 의 축구 경기 정보만 반환하게끔 가공했으며 필요없는 값들은 제거했습니다.
![](https://user-images.githubusercontent.com/52072077/107378633-8392c100-6b2f-11eb-8677-a6c5b797fd53.png)

# 마치며 
API는 제공되는 방식이 많이 존재하고 또 직접 가공해보지 않으면 다루기 어렵습니다. 물론 외부 API를 그대로 반환하여 클라이언트 쪽에서 처리하는 방식도 있지만 서버에서 가공을 하여 반환해 준다면 클라이언트에서 데이터를 처리하기가 훨씬 편하므로 API 가공을 습관화하는 게 좋습니다.